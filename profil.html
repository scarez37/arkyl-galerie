<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profil Artiste - ARKYL</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Poppins', sans-serif; margin: 0; background: #f9f9f9; }
        .hero-artiste { background: #000; color: white; padding: 60px 20px; text-align: center; }
        .container { max-width: 1100px; margin: -40px auto 40px; padding: 0 20px; }
        .profile-card { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); text-align: center; }
        .grid-oeuvres { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 25px; margin-top: 40px; }
        .card { background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .card img { width: 100%; height: 250px; object-fit: cover; }
        .card-body { padding: 15px; }
        .btn-retour { position: absolute; top: 20px; left: 20px; color: white; text-decoration: none; border: 1px solid white; padding: 8px 15px; border-radius: 5px; }
    </style>
</head>
<body>

    <div class="hero-artiste">
        <a href="index.html" class="btn-retour"><i class="fas fa-arrow-left"></i> Retour</a>
        <h1 id="artist-name">Chargement...</h1>
        <p id="artist-bio">Découvrez les œuvres uniques de cet artiste sur ARKYL.</p>
    </div>

    <div class="container">
        <div class="profile-card">
            <h2 style="margin-bottom: 10px;">Galerie de l'artiste</h2>
            <p id="works-count">0 œuvre(s) disponible(s)</p>
        </div>

        <div id="artist-grid" class="grid-oeuvres">
            </div>
    </div>

    <script>
        async function chargerProfil() {
            // 1. Récupérer l'ID de l'artiste dans l'adresse (URL)
            const urlParams = new URLSearchParams(window.location.search);
            const artistId = urlParams.get('id');

            if (!artistId) {
                window.location.href = 'index.html';
                return;
            }

            try {
                // 2. On utilise ton API publique qui contient déjà toutes les infos
                const response = await fetch(`api_galerie_publique.php?t=${Date.now()}`);
                const result = await response.json();

                if (result.success) {
                    // 3. Filtrer pour ne garder que les œuvres de cet artiste précis
                    const oeuvres = result.data.filter(art => art.artist_id == artistId);
                    
                    if (oeuvres.length > 0) {
                        document.getElementById('artist-name').textContent = oeuvres[0].artist_name;
                        document.getElementById('works-count').textContent = `${oeuvres.length} œuvre(s) disponible(s)`;
                        
                        const grid = document.getElementById('artist-grid');
                        grid.innerHTML = oeuvres.map(art => `
                            <div class="card">
                                <img src="${art.image_url}" alt="${art.title}">
                                <div class="card-body">
                                    <h3>${art.title}</h3>
                                    <p style="color: #d4af37; font-weight: bold;">${art.price}</p>
                                    <button onclick="alert('Achat bientôt disponible')" style="width:100%; background:black; color:white; border:none; padding:10px; border-radius:5px; cursor:pointer;">Voir l'œuvre</button>
                                </div>
                            </div>
                        `).join('');
                    } else {
                        document.getElementById('artist-name').textContent = "Artiste introuvable";
                    }
                }
            } catch (error) {
                console.error("Erreur profil:", error);
            }
        }

        document.addEventListener('DOMContentLoaded', chargerProfil);
    </script>
</body>
</html>
